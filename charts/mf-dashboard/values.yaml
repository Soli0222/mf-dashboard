# 共通設定
nameOverride: ""
fullnameOverride: ""

# イメージ設定
crawler:
  image:
    repository: registry.str08.net/soli0222/mf-crawler
    tag: "0.1.0"
    pullPolicy: Always
  resources:
    requests:
      memory: "512Mi"
      cpu: "250m"
    limits:
      memory: "2Gi"
      cpu: "1000m"
  timeoutMs: 1200000 # 20分
  # デプロイ時に init container としてクローラーを実行するかどうか
  initOnDeploy: false

web:
  image:
    repository: registry.str08.net/soli0222/mf-web
    tag: "0.1.0"
    pullPolicy: Always
  replicaCount: 1
  resources:
    requests:
      memory: "128Mi"
      cpu: "100m"
    limits:
      memory: "512Mi"
      cpu: "500m"

# CronJob 設定
cronjob:
  schedules:
    - "50 21 * * *" # JST 6:50
    - "20 6 * * *" # JST 15:20
  concurrencyPolicy: Forbid
  successfulJobsHistoryLimit: 3
  failedJobsHistoryLimit: 3
  backoffLimit: 2

# 永続化設定
persistence:
  enabled: true
  storageClassName: ""
  accessMode: ReadWriteOnce
  size: 1Gi
  existingClaim: ""

# 認証情報
credentials:
  existingSecret: "mf-dashboard-credentials"
  mfUsername: ""
  mfPassword: ""
  mfTotpSecret: ""

# Slack 通知（オプション）
slack:
  enabled: false
  botToken: ""
  channelId: ""

# Ingress 設定
ingress:
  enabled: true
  className: traefik
  annotations:
    cert-manager.io/cluster-issuer: letsencrypt
  hosts:
    - host: mf-dashboard.str08.net
      paths:
        - path: /
          pathType: Prefix
  tls:
    - hosts:
        - mf-dashboard.str08.net
      secretName: mf-dashboard.str08.net-dns01

# Service 設定
service:
  type: ClusterIP
  port: 80

# Pod Affinity（PVC 共有のため同一ノードに配置）
affinity:
  podAffinity:
    requiredDuringSchedulingIgnoredDuringExecution:
      - labelSelector:
          matchLabels:
            app.kubernetes.io/name: mf-dashboard
        topologyKey: kubernetes.io/hostname
